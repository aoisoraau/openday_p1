<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中文描寫角度：積木小人篇</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: "Microsoft JhengHei", sans-serif; background-color: #f0f0f0; }
        
        /* 介面容器 */
        #ui-container {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            max-width: 320px;
            border: 1px solid #eee;
        }

        h2 { margin-top: 0; color: #2c3e50; font-size: 22px; border-bottom: 2px solid #4CAF50; padding-bottom: 10px; display: inline-block;}
        
        /* 描述文字區域 */
        #description {
            min-height: 90px;
            margin-bottom: 20px;
            color: #555;
            line-height: 1.6;
            font-size: 16px;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }

        /* 按鈕樣式 */
        .btn-group { display: flex; gap: 8px; flex-wrap: wrap; }
        button {
            flex: 1 1 40%;
            padding: 10px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: bold;
            transition: all 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        button:hover { background-color: #45a049; transform: translateY(-2px); }
        button:active { transform: translateY(0); }
    </style>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>

    <div id="ui-container">
        <h2>描寫角度學習機</h2>
        <p style="margin: 5px 0 15px 0; font-size: 14px; color: #888;">觀察對象：積木小學生</p>
        <div id="description">請點擊下方按鈕，改變觀察小學生的角度。</div>
        <div class="btn-group">
            <button onclick="changeView('far')">遠觀 (整體)</button>
            <button onclick="changeView('near')">近觀 (外貌)</button>
            <button onclick="changeView('up')">仰視 (高大)</button>
            <button onclick="changeView('down')">俯視 (渺小)</button>
        </div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // 1. 初始化場景
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87CEEB); // 天空藍
        scene.fog = new THREE.Fog(0x87CEEB, 10, 50); // 加入一點霧氣增加空間感

        // 地板 (草地)
        const planeGeometry = new THREE.PlaneGeometry(100, 100);
        const planeMaterial = new THREE.MeshStandardMaterial({ color: 0x7cfc00 });
        const plane = new THREE.Mesh(planeGeometry, planeMaterial);
        plane.rotation.x = -Math.PI / 2;
        scene.add(plane);

        // 網格輔助線 (非必要，但可增加空間感)
        const gridHelper = new THREE.GridHelper(100, 50, 0xffffff, 0xffffff);
        gridHelper.material.opacity = 0.2;
        gridHelper.material.transparent = true;
        scene.add(gridHelper);

        // 2. 搭建積木小人 (Character Builder)
        const characterGroup = new THREE.Group();

        // 材質設定
        const skinMat = new THREE.MeshStandardMaterial({ color: 0xffccaa }); // 膚色
        const shirtMat = new THREE.MeshStandardMaterial({ color: 0x3498db }); // 藍色上衣
        const pantsMat = new THREE.MeshStandardMaterial({ color: 0x34495e }); // 深色褲子
        const shoesMat = new THREE.MeshStandardMaterial({ color: 0x000000 }); // 黑鞋
        const eyeMat = new THREE.MeshBasicMaterial({ color: 0x000000 }); // 眼睛

        // --- 身體部件 ---
        
        // 頭 (Head)
        const headGeo = new THREE.BoxGeometry(0.8, 0.8, 0.8);
        const head = new THREE.Mesh(headGeo, skinMat);
        head.position.y = 2.8;
        characterGroup.add(head);

        // 眼睛 (Eyes) - 為了可愛，加兩個小黑點
        const eyeGeo = new THREE.BoxGeometry(0.1, 0.1, 0.05);
        const leftEye = new THREE.Mesh(eyeGeo, eyeMat);
        leftEye.position.set(-0.2, 2.8, 0.4); // 放在臉稍微前面一點
        characterGroup.add(leftEye);
        const rightEye = new THREE.Mesh(eyeGeo, eyeMat);
        rightEye.position.set(0.2, 2.8, 0.4);
        characterGroup.add(rightEye);

        // 身體 (Body)
        const bodyGeo = new THREE.BoxGeometry(1, 1.2, 0.5);
        const body = new THREE.Mesh(bodyGeo, shirtMat);
        body.position.y = 1.8;
        characterGroup.add(body);

        // 右手 (Right Arm)
        const armGeo = new THREE.BoxGeometry(0.3, 1, 0.3);
        const rightArm = new THREE.Mesh(armGeo, skinMat);
        rightArm.position.set(0.75, 1.8, 0);
        characterGroup.add(rightArm);

        // 左手 (Left Arm) - 舉起來打招呼！
        const leftArm = new THREE.Mesh(armGeo, skinMat);
        leftArm.position.set(-0.75, 2, 0); 
        leftArm.rotation.z = Math.PI / 4; // 旋轉一下
        characterGroup.add(leftArm);

        // 右腿 (Right Leg)
        const legGeo = new THREE.BoxGeometry(0.35, 1.2, 0.35);
        const rightLeg = new THREE.Mesh(legGeo, pantsMat);
        rightLeg.position.set(0.25, 0.6, 0);
        characterGroup.add(rightLeg);

        // 左腿 (Left Leg)
        const leftLeg = new THREE.Mesh(legGeo, pantsMat);
        leftLeg.position.set(-0.25, 0.6, 0);
        characterGroup.add(leftLeg);

        // 鞋子
        const shoeGeo = new THREE.BoxGeometry(0.4, 0.2, 0.5);
        const rightShoe = new THREE.Mesh(shoeGeo, shoesMat);
        rightShoe.position.set(0.25, 0.1, 0.05);
        characterGroup.add(rightShoe);
        const leftShoe = new THREE.Mesh(shoeGeo, shoesMat);
        leftShoe.position.set(-0.25, 0.1, 0.05);
        characterGroup.add(leftShoe);

        scene.add(characterGroup);

        // 3. 燈光設定
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
        scene.add(ambientLight);
        
        const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
        dirLight.position.set(5, 10, 7);
        dirLight.castShadow = true; // 雖然這裡沒開陰影運算，但保留設定
        scene.add(dirLight);

        // 4. 攝影機設定
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        
        // 設定焦點在小人的胸口附近
        const targetPoint = new THREE.Vector3(0, 1.8, 0);
        controls.target.copy(targetPoint);

        // 初始位置
        camera.position.set(8, 5, 8);
        controls.update();

        // 5. 視角切換邏輯
        window.changeView = function(type) {
            const desc = document.getElementById('description');
            
            switch(type) {
                case 'far':
                    // 遠觀：看全景
                    camera.position.set(12, 6, 12);
                    controls.target.set(0, 1.5, 0);
                    desc.innerHTML = "<strong>【遠觀】</strong><br>鏡頭拉遠。我看見小學生站在廣闊的草地上，他在向我揮手，顯得很有活力。";
                    break;
                case 'near':
                    // 近觀：看臉部特寫
                    camera.position.set(0, 2.8, 2.5);
                    controls.target.set(0, 2.6, 0); // 看眼睛附近
                    desc.innerHTML = "<strong>【近觀】</strong><br>鏡頭拉近。我看清了他的臉，圓圓的眼睛炯炯有神，嘴角還掛著微笑，似乎在歡迎我們。";
                    break;
                case 'up':
                    // 仰視：放在腳邊往上看
                    camera.position.set(2, 0.2, 2);
                    controls.target.set(0, 2, 0);
                    desc.innerHTML = "<strong>【仰視】</strong><br>蹲下來往上看。這個角度讓小學生看起來像個巨人一樣高大，特別是他那舉起的手臂，彷彿能碰到天空。";
                    break;
                case 'down':
                    // 俯視：從頭頂往下看
                    camera.position.set(0, 6, 3); // 拉高 Y 軸
                    controls.target.set(0, 0, 0);
                    desc.innerHTML = "<strong>【俯視】</strong><br>從高處往下看。小學生的頭頂方方的，看起來很可愛，整個人小小的，像個玩具模型。";
                    break;
            }
            controls.update();
        }

        // 6. 動畫循環
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            
            // 讓小人輕微浮動，增加一點生動感
            // characterGroup.position.y = Math.sin(Date.now() * 0.002) * 0.1;
            
            renderer.render(scene, camera);
        }
        animate();

        // RWD
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.render(scene, camera);
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
